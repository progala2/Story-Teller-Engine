<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Parser.Game.Location.Travel</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><a href="Extensions.Errors.html"><span class="hs-identifier">Extensions.Errors</span></a><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Game.GameState.html"><span class="hs-identifier">Game.GameState</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">G</span><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Parser.Text.Tokens.html"><span class="hs-identifier">Parser.Text.Tokens</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-identifier">travel</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><a href="Parser.Text.Tokens.html#LocTravel"><span class="hs-identifier hs-type">T.LocTravel</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#LocName"><span class="hs-identifier hs-type">G.LocName</span></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#LocCanTravel"><span class="hs-identifier hs-type">G.LocCanTravel</span></a><span class="hs-special">)</span><span>
</span><a name="line-8"></a><a name="travel"><a href="Parser.Game.Location.Travel.html#travel"><span class="hs-identifier">travel</span></a></a><span> </span><a name="local-6989586621679064222"><a href="#local-6989586621679064222"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679064223"><a href="#local-6989586621679064223"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679064223"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-9"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679064227"><a href="#local-6989586621679064227"><span class="hs-identifier">k</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Parser.Text.Tokens.html#LocCannotTravel"><span class="hs-identifier hs-var">T.LocCannotTravel</span></a><span> </span><span class="hs-special">(</span><a href="Parser.Text.Tokens.html#Local"><span class="hs-identifier hs-var">T.Local</span></a><span> </span><a name="local-6989586621679064228"><a href="#local-6989586621679064228"><span class="hs-identifier">idL</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679064229"><a href="#local-6989586621679064229"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679064224"><span class="hs-identifier hs-var">cantSameLoc</span></a><span> </span><a href="#local-6989586621679064227"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#LocName"><span class="hs-identifier hs-var">G.LocName</span></a><span> </span><a href="#local-6989586621679064227"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#LocCannotTravel"><span class="hs-identifier hs-var">G.LocCannotTravel</span></a><span> </span><a href="Game.GameState.html#CondLocal"><span class="hs-identifier hs-var">G.CondLocal</span></a><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#CondId"><span class="hs-identifier hs-var">G.CondId</span></a><span> </span><a href="#local-6989586621679064228"><span class="hs-identifier hs-var">idL</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679064229"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>
</span><a name="line-10"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679064230"><a href="#local-6989586621679064230"><span class="hs-identifier">k</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Parser.Text.Tokens.html#LocCannotTravel"><span class="hs-identifier hs-var">T.LocCannotTravel</span></a><span> </span><span class="hs-special">(</span><a href="Parser.Text.Tokens.html#Global"><span class="hs-identifier hs-var">T.Global</span></a><span> </span><a name="local-6989586621679064231"><a href="#local-6989586621679064231"><span class="hs-identifier">idG</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679064232"><a href="#local-6989586621679064232"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679064224"><span class="hs-identifier hs-var">cantSameLoc</span></a><span> </span><a href="#local-6989586621679064230"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#LocName"><span class="hs-identifier hs-var">G.LocName</span></a><span> </span><a href="#local-6989586621679064230"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#LocCannotTravel"><span class="hs-identifier hs-var">G.LocCannotTravel</span></a><span> </span><a href="Game.GameState.html#CondGlobal"><span class="hs-identifier hs-var">G.CondGlobal</span></a><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#CondId"><span class="hs-identifier hs-var">G.CondId</span></a><span> </span><a href="#local-6989586621679064231"><span class="hs-identifier hs-var">idG</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679064232"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>
</span><a name="line-11"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679064233"><a href="#local-6989586621679064233"><span class="hs-identifier">k</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Parser.Text.Tokens.html#LocCanTravel"><span class="hs-identifier hs-var">T.LocCanTravel</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679064224"><span class="hs-identifier hs-var">cantSameLoc</span></a><span> </span><a href="#local-6989586621679064233"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#LocName"><span class="hs-identifier hs-var">G.LocName</span></a><span> </span><a href="#local-6989586621679064233"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#LocCanTravel"><span class="hs-identifier hs-var">G.LocCanTravel</span></a><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="Parser.Text.Tokens.html#LocCannotTravel"><span class="hs-identifier hs-var">T.LocCannotTravel</span></a><span> </span><a href="Parser.Text.Tokens.html#None"><span class="hs-identifier hs-var">T.None</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Extensions.Errors.html#errCant"><span class="hs-identifier hs-var">errCant</span></a><span>
</span><a name="line-13"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-14"></a><span>      </span><a name="local-6989586621679064224"><a href="#local-6989586621679064224"><span class="hs-identifier">cantSameLoc</span></a></a><span> </span><a name="local-6989586621679064225"><a href="#local-6989586621679064225"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679064226"><a href="#local-6989586621679064226"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679064225"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679064222"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-string">&quot;You can't have on travel list the same place you are in!&quot;</span><span>
</span><a name="line-16"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679064226"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-17"></a></pre></body></html>