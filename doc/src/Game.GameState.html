<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Game.GameState</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control.Monad.State.Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map.Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldlM</span><span class="hs-special">)</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-comment">-- | 'StateT' 'IO' monad with 'GameStatus'</span><span>
</span><a name="line-10"></a><span class="hs-keyword">type</span><span> </span><a name="GameStateIO"><a href="Game.GameState.html#GameStateIO"><span class="hs-identifier">GameStateIO</span></a></a><span> </span><a name="local-6989586621679042642"><a href="#local-6989586621679042642"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">S.StateT</span><span> </span><a href="Game.GameState.html#GameStatus"><span class="hs-identifier hs-type">GameStatus</span></a><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679042642"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-11"></a><span class="hs-comment">-- | 'StateT' monad with 'GameStatus'</span><span>
</span><a name="line-12"></a><span class="hs-keyword">type</span><span> </span><a name="GameStateM"><a href="Game.GameState.html#GameStateM"><span class="hs-identifier">GameStateM</span></a></a><span> </span><a name="local-6989586621679042640"><a href="#local-6989586621679042640"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679042641"><a href="#local-6989586621679042641"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">S.StateT</span><span> </span><a href="Game.GameState.html#GameStatus"><span class="hs-identifier hs-type">GameStatus</span></a><span> </span><a href="#local-6989586621679042640"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679042641"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-comment">-- | Helper for taking only locations data ('LocationP', 'LocMap') from 'GameStatus'.</span><span>
</span><a name="line-15"></a><span class="hs-identifier">getLocations</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679042650"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Game.GameState.html#GameStateM"><span class="hs-identifier hs-type">GameStateM</span></a><span> </span><a href="#local-6989586621679042650"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#LocationP"><span class="hs-identifier hs-type">LocationP</span></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#LocMap"><span class="hs-identifier hs-type">LocMap</span></a><span class="hs-special">)</span><span>
</span><a name="line-16"></a><a name="getLocations"><a href="Game.GameState.html#getLocations"><span class="hs-identifier">getLocations</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-17"></a><span>  </span><span class="hs-special">(</span><a href="Game.GameState.html#PlayerStatus"><span class="hs-identifier hs-var">PlayerStatus</span></a><span> </span><a name="local-6989586621679042816"><a href="#local-6989586621679042816"><span class="hs-identifier">currLoc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679042817"><a href="#local-6989586621679042817"><span class="hs-identifier">locations</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">S.get</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679042816"><span class="hs-identifier hs-var">currLoc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679042817"><span class="hs-identifier hs-var">locations</span></a><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-comment">-- | Helper for taking only 'PlayerStatus' data from 'GameStatus'.</span><span>
</span><a name="line-21"></a><span class="hs-identifier">getPlayerStatus</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679042649"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Game.GameState.html#GameStateM"><span class="hs-identifier hs-type">GameStateM</span></a><span> </span><a href="#local-6989586621679042649"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Game.GameState.html#PlayerStatus"><span class="hs-identifier hs-type">PlayerStatus</span></a><span>
</span><a name="line-22"></a><a name="getPlayerStatus"><a href="Game.GameState.html#getPlayerStatus"><span class="hs-identifier">getPlayerStatus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-23"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679042818"><a href="#local-6989586621679042818"><span class="hs-identifier">ps</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">S.get</span><span>
</span><a name="line-24"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679042818"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-comment">-- | Provide the whole description of the 'Location' the player is in, taking 'Condition's into consideration if necessary.</span><span>
</span><a name="line-27"></a><span class="hs-comment">-- if 'Condition' for description of the current 'Location' is not met it will not be added to the result.</span><span>
</span><a name="line-28"></a><span class="hs-identifier">showDescription</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679042648"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Game.GameState.html#GameStateM"><span class="hs-identifier hs-type">GameStateM</span></a><span> </span><a href="#local-6989586621679042648"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-29"></a><a name="showDescription"><a href="Game.GameState.html#showDescription"><span class="hs-identifier">showDescription</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-30"></a><span>  </span><span class="hs-special">(</span><a href="Game.GameState.html#PlayerStatus"><span class="hs-identifier hs-var">PlayerStatus</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679042826"><a href="#local-6989586621679042826"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Game.GameState.html#getPlayerStatus"><span class="hs-identifier hs-var">getPlayerStatus</span></a><span>
</span><a name="line-31"></a><span>  </span><a name="local-6989586621679042827"><a href="#local-6989586621679042827"><span class="hs-identifier">descL</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">foldlM</span><span> </span><a href="#local-6989586621679042819"><span class="hs-identifier hs-var">desc</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">M.elems</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lcDescList</span><span> </span><a href="#local-6989586621679042826"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><a href="#local-6989586621679042827"><span class="hs-identifier hs-var">descL</span></a><span>
</span><a name="line-33"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-34"></a><span>    </span><a name="local-6989586621679042819"><a href="#local-6989586621679042819"><span class="hs-identifier">desc</span></a></a><span> </span><a name="local-6989586621679042820"><a href="#local-6989586621679042820"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#LocDesc"><span class="hs-identifier hs-var">LocDesc</span></a><span> </span><a name="local-6989586621679042821"><a href="#local-6989586621679042821"><span class="hs-identifier">str</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679042821"><span class="hs-identifier hs-var">str</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679042820"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-35"></a><span>    </span><span class="hs-identifier">desc</span><span> </span><a name="local-6989586621679042822"><a href="#local-6989586621679042822"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#LocDescCond"><span class="hs-identifier hs-var">LocDescCond</span></a><span> </span><a name="local-6989586621679042823"><a href="#local-6989586621679042823"><span class="hs-identifier">ct</span></a></a><span> </span><a name="local-6989586621679042824"><a href="#local-6989586621679042824"><span class="hs-identifier">cid</span></a></a><span> </span><a name="local-6989586621679042825"><a href="#local-6989586621679042825"><span class="hs-identifier">str</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Game.GameState.html#checkConditionWith"><span class="hs-identifier hs-var">checkConditionWith</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679042823"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679042824"><span class="hs-identifier hs-var">cid</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679042825"><span class="hs-identifier hs-var">str</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679042822"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042822"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">-- | Check whetever the given 'Condition', indexed by 'CondType' and 'CondId', is true in current state of a game.</span><span>
</span><a name="line-38"></a><span class="hs-identifier">checkCondition</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679042647"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Game.GameState.html#CondKey"><span class="hs-identifier hs-type">CondKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#GameStateM"><span class="hs-identifier hs-type">GameStateM</span></a><span> </span><a href="#local-6989586621679042647"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-39"></a><a name="checkCondition"><a href="Game.GameState.html#checkCondition"><span class="hs-identifier">checkCondition</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679042985"><a href="#local-6989586621679042985"><span class="hs-identifier">ct</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679042986"><a href="#local-6989586621679042986"><span class="hs-identifier">cid</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679042996"><a href="#local-6989586621679042996"><span class="hs-identifier">ps</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Game.GameState.html#PlayerStatus"><span class="hs-identifier hs-var">PlayerStatus</span></a><span> </span><a name="local-6989586621679042997"><a href="#local-6989586621679042997"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679042998"><a href="#local-6989586621679042998"><span class="hs-identifier">go</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">S.get</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679042985"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-42"></a><span>    </span><a href="Game.GameState.html#CondLocal"><span class="hs-identifier hs-var">CondLocal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679042987"><span class="hs-identifier hs-var">condition</span></a><span> </span><a href="#local-6989586621679042996"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621679042997"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Game.GameState.html#lcCondition"><span class="hs-identifier hs-var">lcCondition</span></a><span> </span><a href="#local-6989586621679042997"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679042986"><span class="hs-identifier hs-var">cid</span></a><span>
</span><a name="line-43"></a><span>    </span><a href="Game.GameState.html#CondGlobal"><span class="hs-identifier hs-var">CondGlobal</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679042987"><span class="hs-identifier hs-var">condition</span></a><span> </span><a href="#local-6989586621679042996"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621679042997"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Game.GameState.html#goCondition"><span class="hs-identifier hs-var">goCondition</span></a><span> </span><a href="#local-6989586621679042998"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679042986"><span class="hs-identifier hs-var">cid</span></a><span>
</span><a name="line-44"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-45"></a><span>      </span><a name="local-6989586621679042987"><a href="#local-6989586621679042987"><span class="hs-identifier">condition</span></a></a><span> </span><a name="local-6989586621679042988"><a href="#local-6989586621679042988"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621679042989"><a href="#local-6989586621679042989"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#Condition"><span class="hs-identifier hs-var">Condition</span></a><span> </span><a name="local-6989586621679042990"><a href="#local-6989586621679042990"><span class="hs-identifier">objs</span></a></a><span> </span><a name="local-6989586621679042991"><a href="#local-6989586621679042991"><span class="hs-identifier">items</span></a></a><span> </span><a name="local-6989586621679042992"><a href="#local-6989586621679042992"><span class="hs-identifier">plIts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679042993"><span class="hs-identifier hs-var">objsNotExist</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679042994"><span class="hs-identifier hs-var">itsExist</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679042995"><span class="hs-identifier hs-var">itsPsExist</span></a><span>
</span><a name="line-46"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-47"></a><span>          </span><a name="local-6989586621679042993"><a href="#local-6989586621679042993"><span class="hs-identifier">objsNotExist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#lcObjExists"><span class="hs-identifier hs-var">lcObjExists</span></a><span> </span><a href="#local-6989586621679042989"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042990"><span class="hs-identifier hs-var">objs</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>          </span><a name="local-6989586621679042994"><a href="#local-6989586621679042994"><span class="hs-identifier">itsExist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#lcItemExists"><span class="hs-identifier hs-var">lcItemExists</span></a><span> </span><a href="#local-6989586621679042989"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042991"><span class="hs-identifier hs-var">items</span></a><span>
</span><a name="line-49"></a><span>          </span><a name="local-6989586621679042995"><a href="#local-6989586621679042995"><span class="hs-identifier">itsPsExist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#psItemExists"><span class="hs-identifier hs-var">psItemExists</span></a><span> </span><a href="#local-6989586621679042988"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042992"><span class="hs-identifier hs-var">plIts</span></a><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-comment">-- | The same as with 'checkCondition' but you can provide what values should be returned on result</span><span>
</span><a name="line-52"></a><span class="hs-comment">--</span><span>
</span><a name="line-53"></a><span class="hs-comment">-- &gt; checkConditionWith (cl, id) trueValue falseValue</span><span>
</span><a name="line-54"></a><span class="hs-identifier">checkConditionWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679042645"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Game.GameState.html#CondKey"><span class="hs-identifier hs-type">CondKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679042646"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679042646"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#GameStateM"><span class="hs-identifier hs-type">GameStateM</span></a><span> </span><a href="#local-6989586621679042645"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679042646"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-55"></a><a name="checkConditionWith"><a href="Game.GameState.html#checkConditionWith"><span class="hs-identifier">checkConditionWith</span></a></a><span> </span><a name="local-6989586621679042999"><a href="#local-6989586621679042999"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679043000"><a href="#local-6989586621679043000"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679043001"><a href="#local-6989586621679043001"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Game.GameState.html#checkCondition"><span class="hs-identifier hs-var">checkCondition</span></a><span> </span><a href="#local-6989586621679042999"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679043002"><a href="#local-6989586621679043002"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679043002"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679043000"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679043001"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- | The same as with 'checkConditionWith' but in Monad version.</span><span>
</span><a name="line-58"></a><span class="hs-comment">--</span><span>
</span><a name="line-59"></a><span class="hs-comment">-- &gt; checkConditionWithM (cl, id) (Just truValue) Nothing</span><span>
</span><a name="line-60"></a><span class="hs-identifier">checkConditionWithM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679042643"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Game.GameState.html#CondKey"><span class="hs-identifier hs-type">CondKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#GameStateM"><span class="hs-identifier hs-type">GameStateM</span></a><span> </span><a href="#local-6989586621679042643"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679042644"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#GameStateM"><span class="hs-identifier hs-type">GameStateM</span></a><span> </span><a href="#local-6989586621679042643"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679042644"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#GameStateM"><span class="hs-identifier hs-type">GameStateM</span></a><span> </span><a href="#local-6989586621679042643"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679042644"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-61"></a><a name="checkConditionWithM"><a href="Game.GameState.html#checkConditionWithM"><span class="hs-identifier">checkConditionWithM</span></a></a><span> </span><a name="local-6989586621679043003"><a href="#local-6989586621679043003"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679043004"><a href="#local-6989586621679043004"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679043005"><a href="#local-6989586621679043005"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Game.GameState.html#checkCondition"><span class="hs-identifier hs-var">checkCondition</span></a><span> </span><a href="#local-6989586621679043003"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679043006"><a href="#local-6989586621679043006"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679043006"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679043004"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679043005"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-keyword">type</span><span> </span><a name="GameStatus"><a href="Game.GameState.html#GameStatus"><span class="hs-identifier">GameStatus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#PlayerStatus"><span class="hs-identifier hs-type">PlayerStatus</span></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#WorldStatus"><span class="hs-identifier hs-type">WorldStatus</span></a><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span class="hs-comment">-- | Information about player</span><span>
</span><a name="line-65"></a><span class="hs-comment">--</span><span>
</span><a name="line-66"></a><span class="hs-comment">-- [@LocationP@]: Current location of the player.</span><span>
</span><a name="line-67"></a><span class="hs-comment">-- [@ItemSet@]: Items carry on by the player.</span><span>
</span><a name="line-68"></a><span class="hs-keyword">data</span><span> </span><a name="PlayerStatus"><a href="Game.GameState.html#PlayerStatus"><span class="hs-identifier">PlayerStatus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="PlayerStatus"><a href="Game.GameState.html#PlayerStatus"><span class="hs-identifier">PlayerStatus</span></a></a><span> </span><a href="Game.GameState.html#LocationP"><span class="hs-identifier hs-type">LocationP</span></a><span> </span><a href="Game.GameState.html#ItemSet"><span class="hs-identifier hs-type">ItemSet</span></a><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">-- | Check whether the player has the item.</span><span>
</span><a name="line-71"></a><span class="hs-identifier">psItemExists</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Game.GameState.html#PlayerStatus"><span class="hs-identifier hs-type">PlayerStatus</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#Item"><span class="hs-identifier hs-type">Item</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-72"></a><a name="psItemExists"><a href="Game.GameState.html#psItemExists"><span class="hs-identifier">psItemExists</span></a></a><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#PlayerStatus"><span class="hs-identifier hs-var">PlayerStatus</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679043007"><a href="#local-6989586621679043007"><span class="hs-identifier">plItems</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679043008"><a href="#local-6989586621679043008"><span class="hs-identifier">item</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.member</span><span> </span><a href="#local-6989586621679043008"><span class="hs-identifier hs-var">item</span></a><span> </span><a href="#local-6989586621679043007"><span class="hs-identifier hs-var">plItems</span></a><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-keyword">type</span><span> </span><a name="WorldStatus"><a href="Game.GameState.html#WorldStatus"><span class="hs-identifier">WorldStatus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#GameOptions"><span class="hs-identifier hs-type">GameOptions</span></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#LocMap"><span class="hs-identifier hs-type">LocMap</span></a><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-keyword">data</span><span> </span><a name="GameOptions"><a href="Game.GameState.html#GameOptions"><span class="hs-identifier">GameOptions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="GameOptions"><a href="Game.GameState.html#GameOptions"><span class="hs-identifier">GameOptions</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-77"></a><span>    </span><a name="goGameName"><a href="Game.GameState.html#goGameName"><span class="hs-identifier">goGameName</span></a></a><span class="hs-glyph">::</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span>
</span><a name="line-78"></a><span>    </span><a name="goGameVersion"><a href="Game.GameState.html#goGameVersion"><span class="hs-identifier">goGameVersion</span></a></a><span class="hs-glyph">::</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span>
</span><a name="line-79"></a><span>    </span><span class="hs-comment">-- | Define how many items can player can have.</span><span>
</span><a name="line-80"></a><span>    </span><a name="goPlayerCapacity"><a href="Game.GameState.html#goPlayerCapacity"><span class="hs-identifier">goPlayerCapacity</span></a></a><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span>
</span><a name="line-81"></a><span>    </span><span class="hs-comment">-- | Define in which location the game will end.</span><span>
</span><a name="line-82"></a><span>    </span><a name="goEndingLocation"><a href="Game.GameState.html#goEndingLocation"><span class="hs-identifier">goEndingLocation</span></a></a><span class="hs-glyph">::</span><a href="Game.GameState.html#LocName"><span class="hs-identifier hs-type">LocName</span></a><span class="hs-special">,</span><span>
</span><a name="line-83"></a><span>    </span><span class="hs-comment">-- | Global conditions. They apply to every location in the game.</span><span>
</span><a name="line-84"></a><span>    </span><a name="goConditions"><a href="Game.GameState.html#goConditions"><span class="hs-identifier">goConditions</span></a></a><span class="hs-glyph">::</span><a href="Game.GameState.html#Conditions"><span class="hs-identifier hs-type">Conditions</span></a><span class="hs-special">,</span><span>
</span><a name="line-85"></a><span>    </span><span class="hs-comment">-- | Introduction text when a player starts a new game.</span><span>
</span><a name="line-86"></a><span>    </span><a name="goIntro"><a href="Game.GameState.html#goIntro"><span class="hs-identifier">goIntro</span></a></a><span class="hs-glyph">::</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span>
</span><a name="line-87"></a><span>    </span><span class="hs-comment">-- | Outro text when a player finishes a game.</span><span>
</span><a name="line-88"></a><span>    </span><a name="goOutro"><a href="Game.GameState.html#goOutro"><span class="hs-identifier">goOutro</span></a></a><span class="hs-glyph">::</span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-comment">-- | Get a global condition from the game options by its Id.</span><span>
</span><a name="line-92"></a><span class="hs-identifier">goCondition</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Game.GameState.html#GameOptions"><span class="hs-identifier hs-type">GameOptions</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#CondId"><span class="hs-identifier hs-type">CondId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-93"></a><a name="goCondition"><a href="Game.GameState.html#goCondition"><span class="hs-identifier">goCondition</span></a></a><span> </span><a name="local-6989586621679043009"><a href="#local-6989586621679043009"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679043010"><a href="#local-6989586621679043010"><span class="hs-identifier">cid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">goConditions</span><span> </span><a href="#local-6989586621679043009"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">M.!</span><span> </span><a href="#local-6989586621679043010"><span class="hs-identifier hs-var">cid</span></a><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">-- | Data providing all necessary information about location.</span><span>
</span><a name="line-96"></a><span class="hs-keyword">data</span><span> </span><a name="Location"><a href="Game.GameState.html#Location"><span class="hs-identifier">Location</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Location"><a href="Game.GameState.html#Location"><span class="hs-identifier">Location</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-97"></a><span>    </span><a name="lcDescList"><a href="Game.GameState.html#lcDescList"><span class="hs-identifier">lcDescList</span></a></a><span class="hs-glyph">::</span><a href="Game.GameState.html#DescMap"><span class="hs-identifier hs-type">DescMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-98"></a><span>    </span><a name="lcTravelList"><a href="Game.GameState.html#lcTravelList"><span class="hs-identifier">lcTravelList</span></a></a><span class="hs-glyph">::</span><a href="Game.GameState.html#TravelMap"><span class="hs-identifier hs-type">TravelMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-99"></a><span>    </span><a name="lcObjects"><a href="Game.GameState.html#lcObjects"><span class="hs-identifier">lcObjects</span></a></a><span class="hs-glyph">::</span><a href="Game.GameState.html#ObjectSet"><span class="hs-identifier hs-type">ObjectSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-100"></a><span>    </span><a name="lcItems"><a href="Game.GameState.html#lcItems"><span class="hs-identifier">lcItems</span></a></a><span class="hs-glyph">::</span><a href="Game.GameState.html#ItemSet"><span class="hs-identifier hs-type">ItemSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-101"></a><span>    </span><a name="lcActions"><a href="Game.GameState.html#lcActions"><span class="hs-identifier">lcActions</span></a></a><span class="hs-glyph">::</span><a href="Game.GameState.html#Actions"><span class="hs-identifier hs-type">Actions</span></a><span class="hs-special">,</span><span>
</span><a name="line-102"></a><span>    </span><a name="lcConditions"><a href="Game.GameState.html#lcConditions"><span class="hs-identifier">lcConditions</span></a></a><span class="hs-glyph">::</span><a href="Game.GameState.html#Conditions"><span class="hs-identifier hs-type">Conditions</span></a><span>
</span><a name="line-103"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">-- | LocName is the key of the 'Location' data</span><span>
</span><a name="line-106"></a><span class="hs-keyword">newtype</span><span> </span><a name="LocName"><a href="Game.GameState.html#LocName"><span class="hs-identifier">LocName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="LocName"><a href="Game.GameState.html#LocName"><span class="hs-identifier">LocName</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span class="hs-keyword">type</span><span> </span><a name="LocationP"><a href="Game.GameState.html#LocationP"><span class="hs-identifier">LocationP</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#LocName"><span class="hs-identifier hs-type">LocName</span></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#Location"><span class="hs-identifier hs-type">Location</span></a><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span class="hs-keyword">type</span><span> </span><a name="LocMap"><a href="Game.GameState.html#LocMap"><span class="hs-identifier">LocMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">M.Map</span><span> </span><a href="Game.GameState.html#LocName"><span class="hs-identifier hs-type">LocName</span></a><span> </span><a href="Game.GameState.html#Location"><span class="hs-identifier hs-type">Location</span></a><span>
</span><a name="line-109"></a><span class="hs-keyword">type</span><span> </span><a name="DescMap"><a href="Game.GameState.html#DescMap"><span class="hs-identifier">DescMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">M.Map</span><span> </span><a href="Game.GameState.html#DescOrder"><span class="hs-identifier hs-type">DescOrder</span></a><span> </span><a href="Game.GameState.html#LocDesc"><span class="hs-identifier hs-type">LocDesc</span></a><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span class="hs-keyword">type</span><span> </span><a name="TravelMap"><a href="Game.GameState.html#TravelMap"><span class="hs-identifier">TravelMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">M.Map</span><span> </span><a href="Game.GameState.html#LocName"><span class="hs-identifier hs-type">LocName</span></a><span> </span><a href="Game.GameState.html#LocCanTravel"><span class="hs-identifier hs-type">LocCanTravel</span></a><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-comment">-- | Adding items to the given location.</span><span>
</span><a name="line-113"></a><span class="hs-identifier">lcAddItems</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Game.GameState.html#Item"><span class="hs-identifier hs-type">Item</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#LocationP"><span class="hs-identifier hs-type">LocationP</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#LocationP"><span class="hs-identifier hs-type">LocationP</span></a><span>
</span><a name="line-114"></a><a name="lcAddItems"><a href="Game.GameState.html#lcAddItems"><span class="hs-identifier">lcAddItems</span></a></a><span> </span><a name="local-6989586621679043011"><a href="#local-6989586621679043011"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679043012"><a href="#local-6989586621679043012"><span class="hs-identifier">nm</span></a></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#Location"><span class="hs-identifier hs-var">Location</span></a><span> </span><a name="local-6989586621679043013"><a href="#local-6989586621679043013"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679043014"><a href="#local-6989586621679043014"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679043015"><a href="#local-6989586621679043015"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679043016"><a href="#local-6989586621679043016"><span class="hs-identifier">itms</span></a></a><span> </span><a name="local-6989586621679043017"><a href="#local-6989586621679043017"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679043018"><a href="#local-6989586621679043018"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-115"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679043012"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#Location"><span class="hs-identifier hs-var">Location</span></a><span> </span><a href="#local-6989586621679043013"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679043014"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679043015"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.union</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.fromList</span><span> </span><a href="#local-6989586621679043011"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679043016"><span class="hs-identifier hs-var">itms</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679043017"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679043018"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span class="hs-comment">-- | Removing objects from the given location.</span><span>
</span><a name="line-117"></a><span class="hs-identifier">lcRemoveObjects</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Game.GameState.html#Object"><span class="hs-identifier hs-type">Object</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#LocationP"><span class="hs-identifier hs-type">LocationP</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#LocationP"><span class="hs-identifier hs-type">LocationP</span></a><span>
</span><a name="line-118"></a><a name="lcRemoveObjects"><a href="Game.GameState.html#lcRemoveObjects"><span class="hs-identifier">lcRemoveObjects</span></a></a><span> </span><a name="local-6989586621679043019"><a href="#local-6989586621679043019"><span class="hs-identifier">os</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679043020"><a href="#local-6989586621679043020"><span class="hs-identifier">nm</span></a></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#Location"><span class="hs-identifier hs-var">Location</span></a><span> </span><a name="local-6989586621679043021"><a href="#local-6989586621679043021"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679043022"><a href="#local-6989586621679043022"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679043023"><a href="#local-6989586621679043023"><span class="hs-identifier">objs</span></a></a><span> </span><a name="local-6989586621679043024"><a href="#local-6989586621679043024"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679043025"><a href="#local-6989586621679043025"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679043026"><a href="#local-6989586621679043026"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-119"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679043020"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#Location"><span class="hs-identifier hs-var">Location</span></a><span> </span><a href="#local-6989586621679043021"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679043022"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679043023"><span class="hs-identifier hs-var">objs</span></a><span> </span><span class="hs-operator hs-var">Set.\\</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.fromList</span><span> </span><a href="#local-6989586621679043019"><span class="hs-identifier hs-var">os</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679043024"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679043025"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679043026"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span class="hs-comment">-- | Removing an item from the given location.</span><span>
</span><a name="line-121"></a><span class="hs-identifier">lcRemoveItem</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Game.GameState.html#Item"><span class="hs-identifier hs-type">Item</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#LocationP"><span class="hs-identifier hs-type">LocationP</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#LocationP"><span class="hs-identifier hs-type">LocationP</span></a><span>
</span><a name="line-122"></a><a name="lcRemoveItem"><a href="Game.GameState.html#lcRemoveItem"><span class="hs-identifier">lcRemoveItem</span></a></a><span> </span><a name="local-6989586621679043027"><a href="#local-6989586621679043027"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679043028"><a href="#local-6989586621679043028"><span class="hs-identifier">nm</span></a></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#Location"><span class="hs-identifier hs-var">Location</span></a><span> </span><a name="local-6989586621679043029"><a href="#local-6989586621679043029"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679043030"><a href="#local-6989586621679043030"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679043031"><a href="#local-6989586621679043031"><span class="hs-identifier">objs</span></a></a><span> </span><a name="local-6989586621679043032"><a href="#local-6989586621679043032"><span class="hs-identifier">itms</span></a></a><span> </span><a name="local-6989586621679043033"><a href="#local-6989586621679043033"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679043034"><a href="#local-6989586621679043034"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-123"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679043028"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#Location"><span class="hs-identifier hs-var">Location</span></a><span> </span><a href="#local-6989586621679043029"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679043030"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679043031"><span class="hs-identifier hs-var">objs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set.delete</span><span> </span><a href="#local-6989586621679043027"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679043032"><span class="hs-identifier hs-var">itms</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679043033"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679043034"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span class="hs-comment">-- | Check whether the item exists in the given location.</span><span>
</span><a name="line-125"></a><span class="hs-identifier">lcItemExists</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Game.GameState.html#LocationP"><span class="hs-identifier hs-type">LocationP</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#Item"><span class="hs-identifier hs-type">Item</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-126"></a><a name="lcItemExists"><a href="Game.GameState.html#lcItemExists"><span class="hs-identifier">lcItemExists</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679043035"><a href="#local-6989586621679043035"><span class="hs-identifier">loc</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679043036"><a href="#local-6989586621679043036"><span class="hs-identifier">it</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679043036"><span class="hs-identifier hs-var">it</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">Set.member</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">lcItems</span><span> </span><a href="#local-6989586621679043035"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-comment">-- | Check whether the object exists in the given location.</span><span>
</span><a name="line-129"></a><span class="hs-identifier">lcObjExists</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Game.GameState.html#LocationP"><span class="hs-identifier hs-type">LocationP</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#Object"><span class="hs-identifier hs-type">Object</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-130"></a><a name="lcObjExists"><a href="Game.GameState.html#lcObjExists"><span class="hs-identifier">lcObjExists</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679043037"><a href="#local-6989586621679043037"><span class="hs-identifier">loc</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679043038"><a href="#local-6989586621679043038"><span class="hs-identifier">obj</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.member</span><span> </span><a href="#local-6989586621679043038"><span class="hs-identifier hs-var">obj</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">lcObjects</span><span> </span><a href="#local-6989586621679043037"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-comment">-- | Take a condition from the location by its Id. Throws exception when there is no such condition.</span><span>
</span><a name="line-133"></a><span class="hs-identifier">lcCondition</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Game.GameState.html#LocationP"><span class="hs-identifier hs-type">LocationP</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#CondId"><span class="hs-identifier hs-type">CondId</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span>
</span><a name="line-134"></a><a name="lcCondition"><a href="Game.GameState.html#lcCondition"><span class="hs-identifier">lcCondition</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679043039"><a href="#local-6989586621679043039"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679043040"><a href="#local-6989586621679043040"><span class="hs-identifier">cid</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lcConditions</span><span> </span><a href="#local-6989586621679043039"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">M.!</span><span> </span><a href="#local-6989586621679043040"><span class="hs-identifier hs-var">cid</span></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- | Data type that has two constructors: a simple description 'LocDesc' or description displayed only under some condition 'LocDescCond'.</span><span>
</span><a name="line-137"></a><span class="hs-comment">--</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- It is a data type for a 'Location' description.</span><span>
</span><a name="line-139"></a><span class="hs-keyword">data</span><span> </span><a name="LocDesc"><a href="Game.GameState.html#LocDesc"><span class="hs-identifier">LocDesc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="LocDesc"><a href="Game.GameState.html#LocDesc"><span class="hs-identifier">LocDesc</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="LocDescCond"><a href="Game.GameState.html#LocDescCond"><span class="hs-identifier">LocDescCond</span></a></a><span> </span><a href="Game.GameState.html#CondType"><span class="hs-identifier hs-type">CondType</span></a><span> </span><a href="Game.GameState.html#CondId"><span class="hs-identifier hs-type">CondId</span></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- | Unique key for ordering the description on the screen.</span><span>
</span><a name="line-141"></a><span class="hs-keyword">newtype</span><span> </span><a name="DescOrder"><a href="Game.GameState.html#DescOrder"><span class="hs-identifier">DescOrder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="DescOrder"><a href="Game.GameState.html#DescOrder"><span class="hs-identifier">DescOrder</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-comment">-- | Data type used to determine whether a player can travel to a location availible in a current location.</span><span>
</span><a name="line-144"></a><span class="hs-comment">--</span><span>
</span><a name="line-145"></a><span class="hs-comment">-- 'LocCanTravel' - there is no restraints to travel.</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- 'LocCannotTravel' - there is some condition to be met before you can travel.</span><span>
</span><a name="line-147"></a><span class="hs-keyword">data</span><span> </span><a name="LocCanTravel"><a href="Game.GameState.html#LocCanTravel"><span class="hs-identifier">LocCanTravel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="LocCannotTravel"><a href="Game.GameState.html#LocCannotTravel"><span class="hs-identifier">LocCannotTravel</span></a></a><span> </span><a href="Game.GameState.html#CondType"><span class="hs-identifier hs-type">CondType</span></a><span> </span><a href="Game.GameState.html#CondId"><span class="hs-identifier hs-type">CondId</span></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="LocCanTravel"><a href="Game.GameState.html#LocCanTravel"><span class="hs-identifier">LocCanTravel</span></a></a><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-comment">-- | The 'Condition' type stores information about all conditions that need to be satisfied.</span><span>
</span><a name="line-150"></a><span class="hs-comment">--</span><span>
</span><a name="line-151"></a><span class="hs-comment">-- Can have empty parameters. </span><span>
</span><a name="line-152"></a><span class="hs-keyword">data</span><span> </span><a name="Condition"><a href="Game.GameState.html#Condition"><span class="hs-identifier">Condition</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Condition"><a href="Game.GameState.html#Condition"><span class="hs-identifier">Condition</span></a></a><span> </span><a href="Game.GameState.html#ObjectsNotExist"><span class="hs-identifier hs-type">ObjectsNotExist</span></a><span> </span><a href="Game.GameState.html#ItemsInLocation"><span class="hs-identifier hs-type">ItemsInLocation</span></a><span> </span><a href="Game.GameState.html#PlayerHasItems"><span class="hs-identifier hs-type">PlayerHasItems</span></a><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span class="hs-comment">-- | the Enum data to determine whether condition apply only in a location or it is a global condition that can be applied everywhere during the game.</span><span>
</span><a name="line-154"></a><span class="hs-keyword">data</span><span> </span><a name="CondType"><a href="Game.GameState.html#CondType"><span class="hs-identifier">CondType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CondLocal"><a href="Game.GameState.html#CondLocal"><span class="hs-identifier">CondLocal</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="CondGlobal"><a href="Game.GameState.html#CondGlobal"><span class="hs-identifier">CondGlobal</span></a></a><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-155"></a><span class="hs-comment">-- | An unique Id of a condition. Uniquness works separately for each location and for globals ones; in other words two location can have conditions with the same Ids. </span><span>
</span><a name="line-156"></a><span class="hs-keyword">newtype</span><span> </span><a name="CondId"><a href="Game.GameState.html#CondId"><span class="hs-identifier">CondId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CondId"><a href="Game.GameState.html#CondId"><span class="hs-identifier">CondId</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span class="hs-keyword">type</span><span> </span><a name="CondKey"><a href="Game.GameState.html#CondKey"><span class="hs-identifier">CondKey</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#CondType"><span class="hs-identifier hs-type">CondType</span></a><span class="hs-special">,</span><span> </span><a href="Game.GameState.html#CondId"><span class="hs-identifier hs-type">CondId</span></a><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span class="hs-keyword">type</span><span> </span><a name="Conditions"><a href="Game.GameState.html#Conditions"><span class="hs-identifier">Conditions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">M.Map</span><span> </span><a href="Game.GameState.html#CondId"><span class="hs-identifier hs-type">CondId</span></a><span> </span><a href="Game.GameState.html#Condition"><span class="hs-identifier hs-type">Condition</span></a><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-keyword">type</span><span> </span><a name="ObjectsNotExist"><a href="Game.GameState.html#ObjectsNotExist"><span class="hs-identifier">ObjectsNotExist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Game.GameState.html#Object"><span class="hs-identifier hs-type">Object</span></a><span class="hs-special">]</span><span>
</span><a name="line-161"></a><span class="hs-keyword">type</span><span> </span><a name="ItemsInLocation"><a href="Game.GameState.html#ItemsInLocation"><span class="hs-identifier">ItemsInLocation</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Game.GameState.html#Item"><span class="hs-identifier hs-type">Item</span></a><span class="hs-special">]</span><span>
</span><a name="line-162"></a><span class="hs-keyword">type</span><span> </span><a name="PlayerHasItems"><a href="Game.GameState.html#PlayerHasItems"><span class="hs-identifier">PlayerHasItems</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Game.GameState.html#Item"><span class="hs-identifier hs-type">Item</span></a><span class="hs-special">]</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-comment">-- | Action data. </span><span>
</span><a name="line-165"></a><span class="hs-keyword">data</span><span> </span><a name="Action"><a href="Game.GameState.html#Action"><span class="hs-identifier">Action</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-166"></a><span>  </span><span class="hs-comment">-- | Action of using items on some object.</span><span>
</span><a name="line-167"></a><span>  </span><a name="ActionUseItemsOnObject"><a href="Game.GameState.html#ActionUseItemsOnObject"><span class="hs-identifier">ActionUseItemsOnObject</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-168"></a><span>    </span><a name="aItemsUsed"><a href="Game.GameState.html#aItemsUsed"><span class="hs-identifier">aItemsUsed</span></a></a><span class="hs-glyph">::</span><a href="Game.GameState.html#ItemSet"><span class="hs-identifier hs-type">ItemSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-169"></a><span>    </span><a name="aObject"><a href="Game.GameState.html#aObject"><span class="hs-identifier">aObject</span></a></a><span class="hs-glyph">::</span><a href="Game.GameState.html#Object"><span class="hs-identifier hs-type">Object</span></a><span class="hs-special">,</span><span>
</span><a name="line-170"></a><span>    </span><a name="aComment"><a href="Game.GameState.html#aComment"><span class="hs-identifier">aComment</span></a></a><span class="hs-glyph">::</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span>
</span><a name="line-171"></a><span>    </span><a name="aResults"><a href="Game.GameState.html#aResults"><span class="hs-identifier">aResults</span></a></a><span class="hs-glyph">::</span><span class="hs-special">[</span><a href="Game.GameState.html#ActionResult"><span class="hs-identifier hs-type">ActionResult</span></a><span class="hs-special">]</span><span>
</span><a name="line-172"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-173"></a><span>  </span><span class="hs-glyph">|</span><span>
</span><a name="line-174"></a><span>  </span><span class="hs-comment">-- | Action of doing unique command on some object or without an object.</span><span>
</span><a name="line-175"></a><span>  </span><a name="ActionUnique"><a href="Game.GameState.html#ActionUnique"><span class="hs-identifier">ActionUnique</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-176"></a><span>    </span><a name="auCommands"><a href="Game.GameState.html#auCommands"><span class="hs-identifier">auCommands</span></a></a><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-177"></a><span>    </span><a name="aObjectM"><a href="Game.GameState.html#aObjectM"><span class="hs-identifier">aObjectM</span></a></a><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Game.GameState.html#Object"><span class="hs-identifier hs-type">Object</span></a><span class="hs-special">,</span><span>
</span><a name="line-178"></a><span>    </span><a name="aComment"><a href="Game.GameState.html#aComment"><span class="hs-identifier">aComment</span></a></a><span class="hs-glyph">::</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span>
</span><a name="line-179"></a><span>    </span><a name="aResults"><a href="Game.GameState.html#aResults"><span class="hs-identifier">aResults</span></a></a><span class="hs-glyph">::</span><span class="hs-special">[</span><a href="Game.GameState.html#ActionResult"><span class="hs-identifier hs-type">ActionResult</span></a><span class="hs-special">]</span><span>
</span><a name="line-180"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span class="hs-keyword">type</span><span> </span><a name="Actions"><a href="Game.GameState.html#Actions"><span class="hs-identifier">Actions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Game.GameState.html#Action"><span class="hs-identifier hs-type">Action</span></a><span class="hs-special">]</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- | Information about results of some Action.</span><span>
</span><a name="line-183"></a><span class="hs-comment">--</span><span>
</span><a name="line-184"></a><span class="hs-comment">-- [@ArAddLocationItems@] - After an action items will be added to a location.</span><span>
</span><a name="line-185"></a><span class="hs-comment">-- [@ArRemoveObjects@] - After an action objects will be removed from a location.</span><span>
</span><a name="line-186"></a><span class="hs-keyword">data</span><span> </span><a name="ActionResult"><a href="Game.GameState.html#ActionResult"><span class="hs-identifier">ActionResult</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ArAddLocationItems"><a href="Game.GameState.html#ArAddLocationItems"><span class="hs-identifier">ArAddLocationItems</span></a></a><span> </span><span class="hs-special">[</span><a href="Game.GameState.html#Item"><span class="hs-identifier hs-type">Item</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="ArRemoveObjects"><a href="Game.GameState.html#ArRemoveObjects"><span class="hs-identifier">ArRemoveObjects</span></a></a><span> </span><span class="hs-special">[</span><a href="Game.GameState.html#Object"><span class="hs-identifier hs-type">Object</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-comment">-- | Check whether the given action is an 'UniqueAction'.</span><span>
</span><a name="line-189"></a><span class="hs-identifier">isUniqeAction</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Game.GameState.html#Object"><span class="hs-identifier hs-type">Object</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#Action"><span class="hs-identifier hs-type">Action</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-190"></a><a name="isUniqeAction"><a href="Game.GameState.html#isUniqeAction"><span class="hs-identifier">isUniqeAction</span></a></a><span> </span><a name="local-6989586621679043041"><a href="#local-6989586621679043041"><span class="hs-identifier">comm</span></a></a><span> </span><a name="local-6989586621679043042"><a href="#local-6989586621679043042"><span class="hs-identifier">obj</span></a></a><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#ActionUnique"><span class="hs-identifier hs-var">ActionUnique</span></a><span> </span><a name="local-6989586621679043043"><a href="#local-6989586621679043043"><span class="hs-identifier">aComm</span></a></a><span> </span><a name="local-6989586621679043044"><a href="#local-6989586621679043044"><span class="hs-identifier">aObj</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-191"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">elem</span><span> </span><a href="#local-6989586621679043041"><span class="hs-identifier hs-var">comm</span></a><span> </span><a href="#local-6989586621679043043"><span class="hs-identifier hs-var">aComm</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679043044"><span class="hs-identifier hs-var">aObj</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679043042"><span class="hs-identifier hs-var">obj</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-192"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-193"></a><span class="hs-identifier">isUniqeAction</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-comment">-- | Check whether the given action is an 'ItemsOnObjectAction'.</span><span>
</span><a name="line-196"></a><span class="hs-identifier">isItemsOnObjectAction</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set.Set</span><span> </span><a href="Game.GameState.html#Item"><span class="hs-identifier hs-type">Item</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#Object"><span class="hs-identifier hs-type">Object</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#Action"><span class="hs-identifier hs-type">Action</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-197"></a><a name="isItemsOnObjectAction"><a href="Game.GameState.html#isItemsOnObjectAction"><span class="hs-identifier">isItemsOnObjectAction</span></a></a><span> </span><a name="local-6989586621679043045"><a href="#local-6989586621679043045"><span class="hs-identifier">items</span></a></a><span> </span><a name="local-6989586621679043046"><a href="#local-6989586621679043046"><span class="hs-identifier">obj</span></a></a><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#ActionUseItemsOnObject"><span class="hs-identifier hs-var">ActionUseItemsOnObject</span></a><span> </span><a name="local-6989586621679043047"><a href="#local-6989586621679043047"><span class="hs-identifier">aItms</span></a></a><span> </span><a name="local-6989586621679043048"><a href="#local-6989586621679043048"><span class="hs-identifier">aObj</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-198"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Set.difference</span><span> </span><a href="#local-6989586621679043047"><span class="hs-identifier hs-var">aItms</span></a><span> </span><a href="#local-6989586621679043045"><span class="hs-identifier hs-var">items</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Set.empty</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679043048"><span class="hs-identifier hs-var">aObj</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679043046"><span class="hs-identifier hs-var">obj</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-199"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-200"></a><span class="hs-identifier">isItemsOnObjectAction</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-keyword">newtype</span><span> </span><a name="Item"><a href="Game.GameState.html#Item"><span class="hs-identifier">Item</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Item"><a href="Game.GameState.html#Item"><span class="hs-identifier">Item</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span class="hs-keyword">newtype</span><span> </span><a name="Object"><a href="Game.GameState.html#Object"><span class="hs-identifier">Object</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Object"><a href="Game.GameState.html#Object"><span class="hs-identifier">Object</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-keyword">type</span><span> </span><a name="ItemSet"><a href="Game.GameState.html#ItemSet"><span class="hs-identifier">ItemSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Set.Set</span><span> </span><a href="Game.GameState.html#Item"><span class="hs-identifier hs-type">Item</span></a><span>
</span><a name="line-206"></a><span class="hs-keyword">type</span><span> </span><a name="ObjectSet"><a href="Game.GameState.html#ObjectSet"><span class="hs-identifier">ObjectSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Set.Set</span><span> </span><a href="Game.GameState.html#Object"><span class="hs-identifier hs-type">Object</span></a><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span class="hs-identifier">itemSetFromList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Game.GameState.html#ItemSet"><span class="hs-identifier hs-type">ItemSet</span></a><span>
</span><a name="line-209"></a><a name="itemSetFromList"><a href="Game.GameState.html#itemSetFromList"><span class="hs-identifier">itemSetFromList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="Game.GameState.html#Item"><span class="hs-identifier hs-var">Item</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span></pre></body></html>